\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{hyperref}
\usepackage[top=1.2in, bottom=1.2in, left=3cm, right=3cm, a4paper]{geometry}
\usepackage{subcaption}
\usepackage{ragged2e}
\usepackage{amsmath}
\begin{document}

\input{coverpage}
\input{abstract}
\tableofcontents

\pagebreak

\section{Introduction}
\justifying
Glaciers can be defined as a mass of ice that accumulates from snow and flows slowly downwards. The ice sheets are very large mass of this ice of continental scale that flows outwards \cite{anesio2012glaciers}. Some representative examples are Antarctic and Greenland ice sheets. Ice sheets are important components of global climate systems \cite{zhang2017comparison}. The perturbation of these climate systems has several impacts for example, changes in global sea level, as ice sheets grow or decay in response to climate forcing and internally controlled dynamics. The rate of present-day sea-level rise is dominated by ocean steric changes and eustatic changes due to shrinking mountain glaciers, and the eustatic contribution from the large ice sheets (Greenland and Antarctic) has increased in recent decades and it is expected to continue increasing in coming decades and centuries \cite{clark2015recent}. For example, \cite{morlighem2017bedmachine} and \cite{haywood2011pliocene} mentioned that if all the ice were to melt completely, the sea level would rise by an estimated of 65m. Also the Unites Nations states that around 40\% of the world's population lives in coastal regions, within 100km of the coastline \cite{barbier2015climate, montgomery2007united}. The land area that is less than 10m above sea level is just 2\% of the world's total land area, yet it is home to 10\% of the world's population and 13\% of the world's urban population \cite{nevermann2023land}. This indicates the amount of population that could be affected by a sea level rise of this magnitude. 

In order to understand these impacts on the dynamics and melting of ice sheets and glaciers, numerical models are developed. These models are a simplification of reality, and they represent physical real-world processes by a series of equations, which can be solved to understand how the system will respond under different scenarios. The figure \ref{Modelling_process} shows a scheme where the modelling process is described. The mathematical description of a physical process or phenomena can be discretized to be then solved numerically, using a numerical method. However, these mathematical models are usually complicated to discretized or solved numerically, due to the complexity of the differential equations. For this reason, different approximations can be implemented to represent ice flow dynamics that allows to make certain simplifications to these equations. 

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/Numerical_modelling_scheme.png}
	\caption{Process of modelling starting with a physical process which can be described mathematically and turned into a computer code where discretized equations are solved numerically.}
	\label{Modelling_process}
\end{figure}

The different approximations that can be done to the mathematical models that described the glacier dynamics are presented in this document, where the equations of motion will be presented in the next section. Also, the different numerical methods that can be used to solved the approximations of these mathematical methods will be also introduced.  

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/groundingzone.png}
	\caption{Schematic of a tributary glacier where we can observe the different parts denoting the grounding zone \cite{fricker2009mapping}.}
	\label{groundingzone}
\end{figure}

There exist different types of glaciers. Glaciers that end in the ocean are called tidewater glaciers. The ones that flow into an ice shelf are called tributary glaciers as the one shown in figure \ref{groundingzone}. The line that divides the part of the glacier that is in contact with the solid bedrock and the ice shelf floating on water driven by buoyancy, is called the grounding line \cite{cheng2019full}. The location of the grounding line is important because the mass loss from glaciers is strongly linked to changes in the ice shelves and their grounding lines \cite{brunt2010mapping,pritchard2012antarctic}. Its long-term horizontal position is very susceptible to temporal and spatial changes in ice thickness and sea level, as well as bedrock and ice surface slopes. Ice thinning and rising sea levels can cause grounding lines to retreat while thickening or declining sea levels can cause an advance \cite{friedl2020remote}. It is important to know the grounding line position to be able to quantify the ice discharge into the sea and as an indicator, if the ice sheet is advancing or retreating \cite{konrad2018net}.

Grounding lines are actually more of a zone or region where ice transitions from a grounded ice sheet to a freely floating ice shelf, typically over several kilometres. The grounding zone is the region between point F in figure \ref{groundingzone} by \cite{fricker2009mapping}, where there is no tidal movement, and point H, which is the seaward limit of ice flexure, where the ice is free-floating. The floating ice shelf changes in elevation in response to tides, atmospheric air, pressure, and oceanic processes. Grounding occurs when the ice shelf comes into contact with the bedrock below \cite{fricker2009mapping}. The transition from grounded ice sheets to floating ice shelves plays an important role in controlling marine ice sheet dynamics, as it determines the rate at which ice flows out of the grounded part of the ice sheet \cite{schoof2007ice}. This is because ice flux through the grounding line increases sharply with ice thickness at the grounding line. This means that grounding lines are unstable on reverse-bed slopes, such as those under Pine island glaciers, because recession into deeper water increases ice flux and further encourages more glacier recession \cite{schoof2007marine}.

The stability conditions for the position of the grounding line determined by the numerical methods used to solve the glacier dynamics models equations are discussed in this project in section. Also, in the next section a literature review on the grounding line position studies is presented. The impact of parameters such as the mesh resolution on the prediction of the grounding line position is discussed and presented as a research gap and opportunity for the present study that aims to understand and to obtain reliable models able to predict this grounding line dynamics, by implementing experiments on glacier dynamics through idealized topographies presented in section X. 

 \section{Glacier dynamics}
 \subsection{Mass and movement balance equations}
An ice sheet is a continuous sheet of land ice that covers a very large area of several thousand to millions of square meters. It is formed by an accumulation of snow which will densify under its own weight until it becomes ice. This ice will then flow downhill under its weight, and can eventually reach the sea. If it does, and the ice propagates above the sea, this part of the ice sheet is called an ice shelf \cite{hutter1982mathematical}. Figure \ref{groundingline} shows a diagram of an ice sheet showing different parts of it, such as the ice shelf, and the grounded ice. The grounding zone can also be identified. 

Figure \ref{control_volume} shows a control volume of size $dx.dy.dz$. The velocities into the volume in the $x$, $y$ and $z$ directions are $u$, $v$, and $w$, respectively. The velocity out in the $x$-direction is:

\begin{equation}
	u+\frac{\delta u}{\delta x}dx;
\end{equation}

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/Control_volume.png}
	\caption{Derivation of the condition of incompressibility.}
	\label{control_volume}
\end{figure}

Here, $\frac{\delta u}{\delta x}$ is the velocity gradient through the volume, which, when multiplied by the length of the volume, $dx$, gives the change in velocity through the volume in the $x$-direction. The mass fluxes into and out of the volume in the $x$-direction are:
\begin{equation}
	({\rho u + \frac{\delta \rho u}{\delta x}dx})dy dz;
\end{equation}

Here, $\rho$ is the density of the ice. Similar relations may be written for the mass fluxes into and out of the volume control in the $y$ and $z$-directions. Summing these fluxes we find that the change in mass with time, $\frac{\delta m}{\delta t}$ in the control volume is:

\begin{equation}
	\frac{\delta m}{\delta t}=\rho u dydz-({\rho u+\frac{\delta \rho u}{\delta x}})dydz-({\rho v+\frac{\delta \rho v}{\delta y}})dxdz+\rho vdxdz+\rho wdxdy-({\rho w+\frac{\delta \rho w}{\delta z}})dxdy
\end{equation}
Simplifying by cancelling terms of opposite sign and dividing by $dxdydz$ yields to:
\begin{equation}
	-\frac{1}{dxdydz}\frac{\delta m}{\delta t}=\frac{\delta \rho u}{\delta x}+\frac{\delta \rho v}{\delta y}+\frac{\delta \rho w}{\delta z};
\end{equation}
Ice is normally considered incompressible, which means that $\rho$ is constant. This is not true near the surface of a glacier, where snow and firn are undergoing compaction, but to a good approximation is valid throughout the bulk of most ice masses. In this case, the equation becomes:
\begin{equation}
	-\frac{1}{\rho dxdydz}\frac{\delta m}{\delta t}=\frac{\delta u}{\delta x}+\frac{\delta v}{\delta y}+\frac{\delta w}{\delta z};
\end{equation}

The mass of ice in the control volume can change if the control volume is not full initially. When it is full of incompressible ice, however, $\frac{\delta m}{\delta t}=0$, and the equation becomes:
\begin{equation}
	\frac{\delta u}{\delta x}+\frac{\delta v}{\delta y}+\frac{\delta w}{\delta z}=0;
\end{equation}

This is the condition of incompressibility; it describes the situation in which neither mass nor density are changing in the volume control.
\subsubsection{Stresses}
A stress is a force per unit area, and has the dimensions N$m^2$ or Pa. Stresses are vector quantities in that they have a magnitude and direction. Stresses that are directed normal to the surface on which they are acting are called normal stresses, while those that are parallel to the surface are shear stresses. A force applied to a surface at an oblique angle results in both shear and normal stresses on the surface.
As shown in figure \ref{Stress2D}, $\sigma_{XZ}$ is the shear stress in the z‑direction on the plane normal to the $x$-axis. Thus, the ﬁrst subscript in a pair is the orientation of the normal to the plane on which the stress acts, and the second gives the direction of the stress. The figure \ref{Stress_tensor} shows stress vectors on three faces of a cube. Similar stresses occur on the concealed faces, but they are in the opposite directions. The cube is considered to be inﬁnitesimal, representing, say, a point in a glacier. Thus, stresses on any given face can be regarded as uniformly distributed and constant. To completely describe the state of stress at this point, we need nine stress components; thus: $\sigma_{XX}$, $\sigma_{XY}$, $\sigma_{XZ}$, $\sigma_{YX}$, $\sigma_{YY}$, $\sigma_{YZ}$, $\sigma_{ZX}$, $\sigma_{ZY}$, $\sigma_{ZZ}$. This assemblage of stress vectors is called a second-rank tensor. For comparison, a vector, like velocity, is a ﬁrst-rank tensor; to describe it we need its components along three coordinate axes, so we need three numbers. Similarly, pressure, a scaler, is a zero-rank tensor; it can be described with only one number, the magnitude of the pressure.
\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=0.99\linewidth]{../fig/Stress_2D.png}
		\caption{Sign convention for stresses in plain strain.}
		\label{Stress2D}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=0.99\linewidth]{../fig/Stress_tensor.png}
		\caption{Stresses on a cube.}
		\label{Stress_tensor}
	\end{subfigure}
	\caption{Stress in a elementary control volume of ice.}
	\label{Stress}
\end{figure}

\subsubsection{Strain and strain rate}
In a deformable medium, stresses induce deformation or strain. Strain is deﬁned as the change, $\Delta l$, in length of a line divided by the line's initial length, $\Delta l_0$, thus: $\frac{\Delta l}{l_0}$. The symbol $\epsilon$ is commonly used to denote the strain. The rate at which strain occurs, or the strain rate, $\frac{d\epsilon}{dt}$, is denoted as $\dot{\epsilon}$. As nine separate stress vectors are needed to fully describe the state of stress at a point, so also are nine strains or strain rates needed to describe the state of straining at that point. Thus, these assemblages of strains and strain rates are also second rank tensors, the strain and strain-rate tensors. For the strain rate:

\begin{equation}
	\dot{\epsilon_{XY}}=\frac{1}{2}({\frac{\delta u}{\delta y}+\frac{\delta v}{\delta y}});
\end{equation}

Also, the incompressibility condition can be expressed in terms of the strain rate as:

\begin{equation}
	\dot{\epsilon_{XX}}+\dot{\epsilon_{YY}}+\dot{\epsilon_{ZZ}}=0;
\end{equation}

\subsubsection{Yield stress}
In some materials there is no deformation at stresses below a certain stress, called the yield stress. This is a property of that particular material. In other materials, deformation rates are so low at low stresses that theoretical models sometimes assume the existence of a yield stress, even though there may not actually be one. Ice is such a material.

\subsubsection{Deviatoric stress}

Ice does not deform signiﬁcantly in response to hydrostatic pressure alone. In other words, in a topographic depression containing ice the hydrostatic (or
cryostatic) pressure increases linearly with depth, $z$, at a rate $\rho gz$, where $g$ is the acceleration due to gravity. As a rule of thumb, the pressure increases at a rate of 0.1 MPa for every 11m of depth. Thus, it becomes quite high at large depths. However, if the surface of the ice in the depression is horizontal, as in a lake, the only deformation that would occur would be a relatively insigniﬁcant elastic compression.

On the other hand, if the ice surface were to slope gently (dashed line in
Figure \ref{Deviatoric_stress}), and if points A and B are on a horizontal plane, then the pressure at A would be greater than the pressure at B. This pressure difference would result in a compressive strain between A and B. The strain rate would depend upon the small pressure difference, and not, in any signiﬁcant way, on the much larger hydrostatic pressure at depth z. In other words, deformation is a result of the non-hydrostatic stresses. It is convenient to deﬁne a stress, called the deviatoric stress or stress deviator, which reﬂects this principle. The deviatoric normal stress in the x-direction is:

\begin{equation}
	\sigma_{XX}'= \sigma_{XX}-P;
\end{equation}

Where P is the mean normal stress:
\begin{equation}
	P=-\frac{1}{3}({\sigma_{XX}+\sigma_{YY}+\sigma_{ZZ}})
\end{equation}

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/Non_hydrostatic_pressure.png}
	\caption{Sketch to illustrate non-hydrostatic pressure.}
	\label{Deviatoric_stress}
\end{figure}

\subsubsection{The flow law}

The most commonly used ﬂow law for ice is Glen’s ﬂow law, named after John
W. Glen upon whose experiments it is based \cite{glen1958flow}. This equation was originally written in the form:
\begin{equation}
	\dot{\epsilon_{e}}=({\frac{\sigma_{e}}{B}})^n;
\end{equation}
where B is a viscosity parameter that increases as the ice becomes stiffer, and n is an empirically determined constant. Most studies have found that n=3¸. An alternative form of the ﬂow law that is commonly used, and that can be used, is:
\begin{equation}
	\dot{\epsilon_{e}}=A\dot{\epsilon_{e}}^n
\end{equation}
A is called the rate factor. B is normally given in Mpa $yr^{\frac{1}{n}}$ while A is in $MPa^{-n} yr ^{-1}$ or $MPa^{-n} s ^{-1}$.

Glaciers move because the surface of the ice is sloped. This generates a stress on the ice, which is proportional to the slope and to the depth below the surface \cite{earle2015physical}. As shown in fig \ref{Flow_ice}, the stresses are quite small near the ice surface but much larger at depth, and also greater in areas where the ice surface is relatively steep. Ice will deform, meaning that it will behave in a plastic manner, at stress levels of around 100 kilopascals; therefore, in the upper 50 m to 100 m of the ice (above the dashed red line), flow is not plastic (the ice is rigid), while below that depth, ice is plastic and will flow.

When the lower ice of a glacier flows, it moves the upper ice along with it, so although it might seem from the stress patterns (red numbers and red arrows) shown in figure \ref{Flow_ice} that the lower part moves the most, in fact while the lower part deforms (and flows) and the upper part does not deform at all, the upper part moves the fastest because it is pushed along by the lower ice \cite{earle2015physical}.

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/ice_flow.png}
	\caption{Stress within a valley glacier (red numbers) as determined from the slope of the ice surface and the depth within the ice. The ice will deform and flow where the stress is greater than 100 kilopascals, and the relative extent of that deformation is depicted by the red arrows. Any deformation motion in the lower ice will be transmitted to the ice above it, so although the red arrows get shorter toward the top, the ice velocity increases upward (blue arrows). The upper ice (above the red dashed line) does not flow, but it is pushed along with the lower ice. Adapted from \cite{earle2015physical}}
	\label{Flow_ice}
\end{figure}

The plastic lower ice of a glacier can flow like a very viscous fluid, and can therefore flow over irregularities in the base of the ice and around corners \cite{earle2015physical}. For this reason, for large time scales the ice is considered a very viscous fluid. Since the ice is considered an incompressible fluid, such that mass conservation implies that the velocity is divergence free:
\begin{equation}
	\nabla .u=0
\end{equation}
Where $u=(u,v,w)^T$ describes the velocity field of the ice with respect to a cartisian coordinate system. For ice flow, the acceleration term can be neglected in the Navier-Stokes equations \cite{hutter1982mathematical}. Therefore, the ice flow equation can be derived from the conservation of momentum under the action of gravity $g$ \cite{hutter1982mathematical}:
\begin{equation}
	-\nabla p+\nabla (\eta (\nabla u+(\nabla u)^T))+\rho g = 0;
\end{equation}
Where $\nabla$ is the gradient operator, $p$ is the pressure, $\eta$ is the viscosity, $\rho$ is the ice density, and $g$ is the gravity. Letting $\sigma$ denote the stress tensor, pressure $p$ is the mean normal stress denoted previously, and the strain rate tensor $\epsilon_{e}$, related by:
\begin{equation}
	\sigma=2\eta \epsilon_{e}-pI = \eta (\nabla u+(\nabla u)^T)-pI; 
\end{equation}
Where I is the identity tensor. Together, these two last mathematical equations are called the full-stokes model. Observations by \cite{glen1958flow} suggest that the viscosity depends on temperature $T$ and the effective strain rate:
\begin{equation}
	\eta (u,T)=\frac{1}{2}A(T)^{-\frac{1}{n}}\dot{\epsilon_e}^{\frac{1-n}{n}};
\end{equation}
\begin{equation}
	\dot{\epsilon_e}=\sqrt{\frac{1}{2}(({\frac{\delta u}{\delta x})}^2+{(\frac{\delta v}{\delta y})}^2+{(\frac{\delta w}{\delta z})}^2)+{\frac{1}{4}({(\frac{\delta u}{\delta y}+\frac{\delta v}{\delta x})}^2+{(\frac{\delta u}{\delta z}+\frac{\delta w}{\delta x})}^2+{(\frac{\delta v}{\delta z}+\frac{\delta w}{\delta y})}^2)}}
\end{equation}
Where Glenn's exponent n=3. The fluid parameter A increases exponentially with the temperature described by Arrhenius. However, as suggested by \cite{glen1958flow} the viscosity can also be written as:
\begin{equation}
	\eta = \frac{1}{2}(EA)^\frac{-1}{n} \dot{\epsilon_e}^\frac{(1-n)}{n}.
\end{equation}
Where A(T) can be expressed in terms of E and A, where E is an enhancement factor to account for an anisotropic effect (E=1) and A is a rheological parameter A=15,46. From the mass conservation:
\begin{equation}
	\frac{dh}{dt}+ div(uH)=M_s + M_b;
\end{equation}
With $u$ the velocity, H the ice thickness, $M_s$ and $M_b$ the mass balance at the surface and at the bottom respectively. $M_s$ will be defined, and $M_b$ is considered as 0 for convenience purposes. 
\subsection{Shallow shelf approximation}

Floating ice does not experience basal drag, hence all resistance comes from longitudinal stresses all lateral drag at the margins. For ice shelves, the shallow shelf approximation, also called SSA, has been derived by dimensional analysis based on a small aspect ratio and surface slope. This dimensional analysis shows that vertical variation of in $u$ and $v$ is negligible, such that $w$ and $p$ can be eliminated by integrating the remaining stresses over the vertical and applying the boundary conditions at the glacier surface and base. Then, the conservation of momentum simplifies to:
\begin{equation}
	\nabla_h.(2\bar{\eta}(\dot{\epsilon_h}I))=\rho g H \nabla_h z_s;
\end{equation}
Where the subscript h represents the components in the x-y plane, $\bar{\eta}$ the vertically integrated viscosity, H the ice thickness, and $z_s$ the upper ice surface. The effective strain rate simplifies to:

\begin{equation}
	\dot{\epsilon_h}=\sqrt{{\frac{\delta u}{\delta x}}^2+{\frac{\delta v}{\delta y}}^2+\frac{\delta u}{\delta x}\frac{\delta v}{\delta y}+\frac{1}{4}{(\frac{\delta u}{\delta y}+\frac{\delta v}{\delta y})}^2};
\end{equation}
Where $w$ is eliminated using incompressibility. The SSA model is still non linear through $\bar{\eta}$, but since $w$ and $p$ are eliminated and vertical variation in $u$ and $v$ is neglected, the 3-D problem with four unknowns is reduced to a 2-D problem with two unknowns. If desirable, the vertical velocity can also be computed from the incompressibility condition. 

For an ice sheet, the ratio of the vertical length over the horizontal length is more than $1:10^3$. Indeed, the thickness of an ice sheet goes from 0 m to a few thousand of meters (e.g. the ice sheet in Greenland is 3300 m thick at most \cite[]{bamber2001new}) and the typical horizontal length of an ice sheet is of the order of magnitude of 1000 km. This allows us to apply the shallow ice approximation. It assumes a large ratio of horizontal to vertical length, that the basal shear stress is balanced by  the gravitational driving stress, and a large vertical to horizontal stress ratio. That represents a slow flow in the interior of an ice sheet (blue regions in Figure \ref{velocityglaciar}). The approximation makes the method computationally cheaper than the Full-Stokes model with good accuracy over long simulations.

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.7\linewidth]{../fig/velocityglaciar.png}
	\caption{Ice velocities in Antarctica and Greenland topographies, where we can see in red the highest velocity profiles in the glaciers and as a consequence we consider the basal shear stress as 0 and the longitudinal stress dominates, which allows using a Shallow Shelf approximation \cite[]{allison2009ice}.}
	\label{velocityglaciar}
\end{figure}
Figure \ref{velocityglaciar} shows a map of velocities in Antarctica and Greenland topographies. Where this velocity is the highest, the basal shear stress cannot be considered balanced by gravity anymore. Instead, it is taken as 0 and the longitudinal stress dominates. This is the Shallow Shelf approximation, initially developed for ice shelves, but which has been extended to dragging ice streams. It is a 2D vertically integrated model, the ice velocity being depth-averaged.

But these approximations are not mandatory: the Full Stokes model is still the most precise, it accounts for all nine stress components. It is useful around the parts that are at the limits of the other models or over complex topographies, but not needed for the interior of ice sheets, where the improvement would be minimal but the computational cost way higher \cite{larour2012continental}.

The factors such as sensitivity, long time intervals, and long distances require careful treatment of the groundline neighborhood by the numerical method to discretize the model equations \cite{cheng2019full}. The most accurate ice model is the Full Stokes (FS) equations \cite{cheng2019full}. However, a simplification of these FS equations by integrating into the depth of the ice is the shallow shelf approximation \cite{macayeal1989large}. The computational advantage with Shallow Shelf approximation is that the dimension of the problem is reduced by one, it is often used for simulations of the interaction between a grounded ice sheet and a marine ice shelf \cite{cheng2019full}. 
In this project, only the Shallow Shelf approximation is made, as this is how future projections of Greenland and Antarctica are done with the Elmer/Ice model.

\subsection{Grounding line stability}

There are different variables that play an important role in the dynamics of the glaciers. There is, for example, the grounding line. Its location is still a topic of discussion in the literature surrounding ice sheet dynamics \cite{goldberg2018representing}. A long debate on the dynamics of such ice sheets was initiated in the 1970s when \cite{weertman1974stability} proposed that a marine ice sheet that lies on an upward-sloping bed is unstable. Recently, the instability hypothesis has been strongly reinforced, based on a boundary-layer theory due to \cite{schoof2007ice}. Moreover, \cite{vieli2005assessing} showed the poor ability of marine ice-sheet models to give consistent prognostic results and, more particularly, they highlighted the influence of the grid size on model results. One of their main conclusions was that no reliable model was able to predict grounding line dynamics at the time of their study.

There is a need to improve marine ice-sheets models in order to corroborate recent theoretical predictions and to obtain confident simulations of the grounding line dynamics. \cite{durand2009marine} proposed a full-Stokes solution of the ice-sheet/ice-shelf transition. This approach has been built on literature dealing with the coupling between a grounded ice sheet and a floating ice shelf and identifying this transition zone as a crucial control of the marine ice sheet dynamics, like the studies carried out by \cite{weertman1974stability}, \cite{van1985response}, \cite{schoof2007ice}, and \cite{schoof2007marine}. Also, \cite{chugunov1996modelling} presented a model for the behavior of a marine glacier and ice-sheet-ice-shelf transition zone based on asymptotic analysis, which involves breaking down the equations into simpler components and analyzing their behavior as certain variables approach infinity or zero, to derive a set of simplified equations that can be used to predict the behavior of the glacier and ice-sheet-ice-shelf transition zone. \cite{hindmarsh1996stability} presents a mathematical model of ice rise stability, which takes into account the effects of ice flow, ice shelf melt, and ocean circulation. He uses this model to analyze the stability of several ice rises and uncoupled marine ice sheets in Antarctica, finding that some of these features may be more stable than previously thought. On the other hand, \cite{vieli2005assessing} evaluate the ability of numerical ice sheet models to simulate grounding line migration. They concluded that while numerical ice sheet models have made significant progress in simulating grounding line migration, there is still much work to be done to improve their accuracy and reliability.

\cite{durand2009full} showed, using the finite element code Elmer/Ice, that the full-Stokes modeling of the ice-sheet/ice-shelf transition gives a consistent prediction of grounding-line migration. However, their approach is highly sensitive to the chosen mesh resolution. For a grid size smaller than $5 km$ in the grounding-line vicinity, predictions start to be consistent. For any finer resolution than $5 km$, the steady-state grounding-line position is the same (6km is the standard deviation). If a sub-grid refinement of 200m in the vicinity of the grounding line is applied the steady-state position is stable.

In order to study and test the behavior of the different components of the models, idealized systems are studied and, based on the results that are obtained from these idealized cases, the hypothesis, models, and numerical methods used to solve the problems are improved. For this reason, within the framework of this project, we will analyze the behavior of the Elmer/Ice method to solve idealized systems and topographies. The framework in which the present project is focused is on the study of the Northern Europe glacier. But, since this glacier does not exist anymore, idealized cases simulations of North Europe glaciers, such as Greenland can be analyzed as mentioned before, and their results can be used to improve the numerical models, hypothesis, and parameters of the models, and this way we can better understand the behavior of ancient glaciers such as the Northern Europe glacier.

\section{Systems and domains}

\subsection{Physical constants}
Table \ref{Physical constants} shows the constants parameters that were set up for the experiment by the Calvin MIP project. 

\begin{table}[!h]
	\begin{center}
		\caption{Physical constants}
		\label{Physical constants}
		\begin{tabular}{|l|l|l|}
			\hline
			Variable          & Description                 & Units           \\ \hline
			$g=9.81$         & Gravitational acceleration  & $ms^{-2}$         \\ \hline
			$a_s=0.3$       & Surface mass balance (SMB)  & $ma^{-1}$         \\ \hline
			$a_b=0$             & Basal mass balance (BMB)    & $ma^{-1}$         \\ \hline
			$\rho i=917$        & Ice density                 & $kg m^{-3}$       \\ \hline
			$\rho w=1028$      & Sea water density           & $kg m^{-3}$       \\ \hline
			$A= 2.9377x10^{-9}$ & Ice rate factor             & $KPa^{-3}a^{-1}$  \\ \hline
			$n=3$               & Flow law stress exponent    &                 \\ \hline
			$C=0.001$           & basal slipperiness          & $ma^{-1}Kpa^{-3}$ \\ \hline
			$m=3$               & Sliding law stress exponent &                 \\ \hline
			$s2a=31556926$     & Seconds in a year           & seconds         \\ \hline
		\end{tabular}
	\end{center}
\end{table}

These constants parameters were modified by the Calvin MIP intercomparisson project after the current project was proposed. The water density and the time equivalence from year to seconds was changed from 1030 $kg/m^3$ to 1028 $kg/m^3$ and from 365.2422 days in a year to 31556926 seconds in a year, respectively. All the rest of the parameters remained the same as listed in table \ref{Physical constants}.

For the computation of $u_b=2$, we used the Weertman style sliding law:

\begin{equation}
	u_b = C\tau _b^m
\end{equation}
where C is the basal slipperiness and $\tau _b$ is the basal shear stress.
In order to enter these values into the Elmer code, we need to convert all units to Elmer units, namely: MPa, meter, and years. It means that all units that are derivated from time in seconds, must be converted to time in years using the time equivalence proposed in the project and all units or values expressed in terms of KPa must be multiplied by a factor of $10^{-3}$ to be converted to MPa.
Also, to compute the basal sliding velocity $u_b$, Elmer uses the term $\beta$ that is related to $u_b$ by:
\begin{equation}
	\tau = \beta u_b^{\frac{1}{m}}
\end{equation}
So, we have:
\begin{equation}
	u_b = (\frac{\tau}{\beta})^m;
\end{equation}
\begin{equation}
	u_b = \frac{1}{\beta^m} \tau^m
\end{equation}
Using the notation from equation (1), we can say that $C=  \frac{1}{\beta^m}$. So, we can compute $\beta$ as:
\begin{equation}
	\beta=(\frac{1}{C})^{\frac{1}{3}}
\end{equation}
If we replace C by its value given in table \ref{Physical constants}, we get $\beta= 10^4 Pa m^{\frac{-1}{3}} a^{\frac{1}{3}}$ which converted to Mpa will give us a value of 10.

\subsection{Numerical parameters}
The numerical resolution will be our variable physical parameter, which we will vary from 10 km, 5 km, 2 km, 1 km, 500 m, and 250 m. 
\subsection{External forcing}
We will assume that the only external force acting are gravity ($g=9.81 m/s^2$), which is translated to the weight of the ice sheet and the flotation force of this in the ocean water, as well as the ice friction with the bedrock.
\subsection{Initial condition}
The simulation departs from no iced configuration. 
As stated before, the flow will follow the linear Weertman friction law at the base of the ice sheet:
\begin{equation}
	u_b=C\tau_b^m;
\end{equation}
Where $\tau$ is the friction shear stress, $C$ is the basal slipperiness coefficient, and $u$ is the velocity.
Comparisons were made using friction coefficients ranging from $C=10^{-8}$ to simulate a friction close to 0, to $C=10^{-2}$. This coefficient is also the one chosen to perform the simulations.
The simulations will start from a topography with no ice, namely $h_0 = 0$. However, the Elmer/Ice code uses a notation where at least a minimum value should be enter in order to avoid convergence problems, so a very small value of $h_0 = 0,01$ is introduced as initial ice thickness. 
\subsection{Time step}
The Courant-Friedrichs-Lewy (CFL) condition is a necessary condition to solve numerical partial differential equations. It states that the distance a variable travels between two-time steps must be smaller than the distance between two points of the mesh \cite[]{courant1967partial}. It is needed that:
\begin{equation}
	C=\frac{u\Delta t}{\Delta x}<Cmax;
\end{equation}
With C the courant number, $u$ the magnitude of the velocity, $\Delta t$ the time step, $\Delta x$ the horizontal resolution, and Cmax = 1. This implies then, for a given mesh:
\begin{equation}
	\Delta t < \frac{\Delta x}{u};
\end{equation}
This is a safe approximation. Cmax then has to be estimated by running different parameters in the simulation and seeing if it converges or not. In order to satisfy the CFL condition, a good starting point is 1 year, since it works properly and converges even for a resolution of 1km.
However, in this experiment, it is asked to report the results every 10 years, and for this reason, we will save the results of the simulation with a frequency of 10 years. 

This numerical experiment uses two different topographic profiles. A cone and a more realistic topography (Thule).
\subsection{Cone domain}
The idealized model consists of a circular bedrock configuration (Figure \ref{circular_topo_top}) given by:
\begin{equation}
	\theta=arctan2(y,x);
\end{equation}
\begin{equation}
	I=R-cos(2\theta)\frac{R}{2}
\end{equation}
\begin{equation}
	Bed_0=Bc-(Bc-BI)\frac{|x^2+y^2|}{R2}^;
\end{equation}
Where $R=800x10^3 m$, $Bc=0.9 x 10^3 m$, and $BI=-2 x 10^3 m$. 
\begin{figure}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{../fig/circular_topo_top.png}
	\includegraphics[width=0.45\linewidth]{../fig/circular_topo_jet}
	\caption{Circular bedrock topography. On the left side top view and on the right side, lateral view.}
	\label{circular_topo_top}
\end{figure}

\subsection{Thule domain}
The Thule bedrock configuration is shown in Figure \ref{Thule_3D} and is given by:
\begin{equation}
	\theta=arctan2(y,x);
\end{equation}
\begin{equation}
	I=R-cos(2\theta)\frac{R}{2};
\end{equation}
\begin{equation}
	Bed_0=Bc-(Bc-BI)\frac{|x^2+y^2}{R^2};
\end{equation}
\begin{equation}
	Bed=Bacos(3\pi\frac{\sqrt[2]{x^2+y^2}}{I})+Bed_0;
\end{equation}
With $R=800 x 10^3 m$, $Bc=0,9 x 10^3 m$, $BI=-2 x 10^3 m$, and $Ba=1,1 x 10^3$.
\begin{figure}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{../fig/Thule_2D}
	\includegraphics[width=0.45\linewidth]{../fig/Thule_3D}
	\caption{Thule bedrock topography 3D. On the left side the top view, and on the right side a lateral view.}
	\label{Thule_3D}
\end{figure}

\subsection{Boundary conditions}
Boundary conditions are needed in order to solve differential equations. It will be assumed that:
\begin{itemize}
	\item The bedrock is impermeable (The vertical component of the ice flow velocity is 0):
	\begin{equation}
		v = 0
	\end{equation}
	\item The flow follows the Weertman friction law:
	\begin{equation}
		u_b = C\tau_b^m
	\end{equation}
	\item Mass accumulation is a constant parameter.
	\item The simulation will be performed on a quarter of the domain since the geometry of the topography is symmetric, which allows having free slip boundary conditions at the left and downsides of the topography, and open boundary conditions at the right and top sides of the domain. 
\end{itemize}

 \section{Numerical model}
 \subsection{The Elmer/Ice finite element method}

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.45\linewidth]{../fig/non_structured_grid_10km.png}
	\includegraphics[width=0.45\linewidth]{../fig/regular_grid_10km.png}
	\caption{a) 10km resolution non-structured mesh used in Elmer/Ice. b) Regular structured mesh for 10km resolution.}
	\label{meshes}
\end{figure}

Most of the time analytical solutions are challenging or even impossible to obtain. In order to model ice sheets, both the finite difference method (FDM) and the finite element method (FEM) are used. The finite difference method consists in converting ordinary and partial differential equations into a system of linear equations by approximating derivatives as finite differences. Elmer/Ice, on the other hand, uses the finite element method.

The ice sheet/ice flow model Elmer/Ice includes developments related to glaciological problems and a large number of dedicated solvers and user functions that solve the Full-Stokes equations for various ice rheologies (classical, Glenn's flow law, anisotropic laws, and porous compressible firns/snow law). It includes solvers for the classical asymptotical expansions of the Stokes equations, namely the shallow ice approximation and the shallow and shallow shelf approximation (SSA). All these equations can be solved diagnostically or transiently, allowing the displacement of the boundaries.

Elmer/Ice considers a continuum as an assembly of non-overlapping elements forming the same geometry, which makes the modeling of complex geometries possible. Each element is made of at least two points, which are applied to the forces and computed the displacements. To solve the equations, Elmer/Ice uses subroutines or solvers. Each equation corresponds to one solver to be referenced in the input file, together with the different parameters of the problem. They each compute the evolution of given variables, such as the ice thickness or the velocity, to give at each time step a picture of the flow. All combined, it allows us to visualize the evolution of the flow through time.
 
As mentioned before, the simulations using Elmer/Ice use unstructured meshes, as shown in the left-hand side of figure \ref{meshes} for a 10km resolution mesh. This is very helpful in terms of simulating complex geometries, for example, the thule configuration.


However, once the simulation is done and to better interpret the results obtained, it is needed to build a structured mesh, because it is ideal for these time-domain simulations this it can  easily identified elements and nodes when plotting time-dependent or spacial-dependent graphics. In this case, the objective of interest will be the spacial behaviour or dynamic of the glacier since we will analyse the position of the grounding line after the steady state is reached. To build the structured mesh, an interpolation made from the unstructured mesh values of the nodes is performed, namely an interpolation per each node of the value of the variables of interest with the values of these same variables in the non-structured mesh. This way it can be known which position the node is in, and the spacial dependent variables can be plot; for example, the velocity components as a function of the horizontal position. 

\section{Set-up of the simulations data}
Once both results for both experiments are obtained, for the domain complete and the quarter domain, the grounding line position per each resolution along the profiles proposed will be quantified. For this, a function that can be denominated grounding line needs to be created, and this function is defined as the product of the bedrock position and a grounding mask. This grounded mask is a step function created, which a value of -1 is assigned to the grounded ice, and 1 to the part of the ice that is no longer in contact with the bedrock, namely:

\[ \begin{cases} 
	-1 & bedrock = z_b \\
	1 & z_b \leq bedrock   
\end{cases}
\]

Using this mask, the grounding line function is defined as the negative product of this mask and the bedrock (the negative sign is only implemented for convention). From the fact that this grounding line function is an increasing function, it must have an unique maximum, namely, the point where the function changes sign. This maximum means the point where $z_b$ is no longer equal to bedrock position, so starting from this point, the lower part of the ice sheet is not grounded any more. This maximum value of the grounding line function corresponds, physically, to the point where the grounding line or zone is along an x-profile. Knowing this point, the distance from the origin of our coordinate system to that point can be computed, knowing the x and y coordinates of this point, as the norm if this vector, this distance determines the grounding line position, in meters, along an x axis. The results are calculated in two parts: along three profiles A,B and C for the quarter of the domain, and along all the profiles from A to H for the domain complete, in the case of the Cone domain experiment. For the thule experiment, in the first part the grounding line position along Caprona B and Halbrane B needs to be calculated for the quarter domain, and then along all Capronas and Halbranes profiles for the complete domain. For both cases, per each resolution the mean, maximum and minimum value of the grounding line position was calculated.

\section{Results}
\subsection{Cone configuration}

For this first experiment proposed, the simulations were run varying the resolution from 10km and up to 1km. In figure \ref{figCONO1} we show a qualitative representation of the simulation results for the different resolutions, where we also run 50 and 20km resolution just to have a better idea of how this change in the resolution has an impact in the results. In these figures, the blue part represents the grounded part of the domain, and the grey part represent the floating part. This way we can identify the changes in the transition from grounded to not grounded, namely the grounding zone. We can see also how, as we go closer to a minimum resolution, the differences start to be not that notorious. 

\begin{figure}[!h]
	\centering % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_50km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 50km resolution}
		\label{figCONE50KM}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_20km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 20km resolution}
		\label{figCONE20}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_10km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 10km resolution}
		\label{figCONE10KM}
	\end{subfigure}
	
	\medskip
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_5km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 5km resolution}
		\label{figCONE5}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_2km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 2km resolution}
		\label{figCONE2}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_1km_CONE.png}
		\caption{Grounded zone (blue) and floating ice (grey) for 1km resolution}
		\label{CONE1KM}
	\end{subfigure}
	\caption{Impact of the resolution in the grounded area for the cone circular domain.}
	\label{figCONO1}
\end{figure}

In figure \ref{Cone_scheme}, we see an schematic representation of the results for the cone circular domain experiment. For the analysis of these results, the ice thickness of the profile was analysed along 8 linear profiles, namely A,B,C,D,E,F,G and H for the domain complete, as shown in figure \ref{Schematic_Cone}, and in figure \ref{Profiles_cone} we see all the positions and the ice thickness along the different profiles in the same figure. The point or zone where the lower part of the ice sheet stops being in contact with the bedrock is the grounding line. In this figure it is also highlighted the quarter of the domain in figure \ref{Schematic_Cone} and its three profiles A,B,C since, as mentioned before, both simulations for the domain complete and the quarter domain were run to compare the results.

\begin{figure}
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=0.99\linewidth]{../fig/Profiles_Cone_combined_domains.png}
		\caption{Profiles for Cone circular domain}
		\label{Schematic_Cone}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=0.99\linewidth]{../fig/Profiles_Cone_domain_sin_fondo.png}
		\caption{Ice thickess per profile}
		\label{Profiles_cone}
	\end{subfigure}
	\caption{Schematic representation of the circular domain ice sheet showing the ice thickness results along the profiles proposed.}
	\label{Cone_scheme}
\end{figure}

To have a better idea of the simulations convergence, in figure \ref{h_and_h_velocities_cone} it is shown on the left sides all the values of ice thickness in meters per each resolution, and on the left sides the values of the ice thickness velocity obtained, namely the rate of change of the ice thickness in meters per year. The range of these values, maximum and minimum per resolution are very low (less than 0,001 m/y), which is a brief image that shows that the simulations reached a steady state with a low estimation error. 

\begin{figure}[!h]
	\centering % <-- added
	\begin{minipage}[t]{.45\textwidth}
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/10km_quarter_h_thickness_sin_fondo.png}
			\caption{Ice thickness for 10km resolution.}
			\label{h10km}
		\end{subfigure}\hfil % <-- added
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/5km_quarter_h_thickness_sin_fondo.png}
			\caption{Ice thickness 5km resolution.}
			\label{h5km}
		\end{subfigure}\hfil % <-- added
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/2km_quarter_h_thickness_sin_fondo.png}
			\caption{Ice thickness for 2km resolution.}
			\label{h2km}
		\end{subfigure}
		\begin{subfigure}{\textwidth}
		\includegraphics[width=\linewidth]{../fig/1km_quarter_h_thickness_sin_fondo.png}
		\caption{Ice thickness for 1km resolution.}
		\label{h1km}
	    \end{subfigure}
	\end{minipage}\hfil
	\begin{minipage}[t]{.45\textwidth}
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/10km_quarter_cone_hvelocity_sin_fondo.png}
			\caption{Ice sheet thickness velocity 10km.}
			\label{hvelocity10km}
		\end{subfigure}\hfil % <-- added
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/5km_quarter_cone_hvelocity_sin_fondo.png}
			\caption{Ice sheet thickness velocity 5km}
			\label{hvelocity5km}
		\end{subfigure}\hfil % <-- added
		\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/2km_quarter_cone_hvelocity_sin_fondo.png}
			\caption{Ice sheet thickness velocity 2km}
			\label{hvelocity2km}
		\end{subfigure}
				\begin{subfigure}{\textwidth}
			\includegraphics[width=\linewidth]{../fig/1km_quarter_cone_hvelocity_sin_fondo.png}
			\caption{Ice sheet thickness velocity 1km}
			\label{hvelocity1km}
		\end{subfigure}	
	\end{minipage}
	\caption{Ice thickness and ice sheet thickness rate of change in space for quarter domain per each resolution after steady state.}
	\label{h_and_h_velocities_cone}
\end{figure}

The mean, maximum and minimum value of the grounding line position per resolution is shown in figure \ref{Grounding_lines__CONE_comparison} for both case studies, the quarter and complete domain. In the y-axis we have the grounding line position in meters, that is the distance calculated from an origin to the grounding line or zone computed before using the function. This distance is computed as the norm of a vector (x,y) that defines this grounding line position. 

\begin{figure}[!h]
	\centering
	\includegraphics[width=0.8\linewidth]{../fig/Figure_CONE_GL_positions.png}
	\caption{Grounding line positions as a function of the resolution for quarter and complete circular cone domain.}
	\label{Grounding_lines__CONE_comparison}
\end{figure}

For both cases, the complete and quarter of the domain results, it is associated an error bar for the mean values of the grounding line position. The yellow bar corresponds to the quarter domain mean value error bar, and the blue bar corresponds to the complete domain mean value error bar. The error associated was determined as half of the value for each resolution (5km for the 10km resolution, 2.5km for 5km, 1km for 2km and 500m for 1km resolution).

It can be observed how, for greater resolutions as 10km, the results have a difference of around 20km for the grounding line position between the quarter of the domain and the complete domain results, but for lower resolutions these difference starts to be lower. 

\subsection{Thule configuration}
For the second part of the experiments, the results for the thule configuration were obtained for a quarter of the domain and the domain complete, and following the Calving MIP inter comparison project, the simulations using this topography were run using 10,5,2 and 2 km meshes. The figure \ref{Thule_profiles_capronas_and_halbranes} shows the schematic representation of the thule domain experiment results. Similar to the Cone domain experiment, here it is proposed to analyse the results along profiles called Caprona and Halbrane. The figure \ref{Profiles_Thule} highlights the quarter of the domain, since the simulations were also run for this part of the domain to compare it with the complete system. In this case the results were analysed for Caprona profiles and separately for the Halbrane profiles. In figures \ref{Capronas_thule} and \ref{Halbranes_thule} it can be observed the ice thickness along each one of the profiles and so the position of the grounding line.

\begin{figure}[!h]
  \begin{subfigure}[c]{.52\linewidth}
    \centering
    \includegraphics[width=\linewidth]{../fig/Profiles_Thule_combined_domains_2_con_fondo.png}%
    \caption
      {%
        Profiles for the thule domain%
        \label{Profiles_Thule}%
      }%
  \end{subfigure}\hfill
  \begin{tabular}[c]{@{}c@{}}
    \begin{subfigure}[c]{.48\linewidth}
      \centering
      \includegraphics[width=\linewidth]{../fig/Capronas_Thule_Domain_con_fondo.png}%
      \caption
        {%
          Ice thickness along each Caprona profile%
          \label{Capronas_thule}%
        }%
    \end{subfigure}\\
    \noalign{\bigskip}%
    \begin{subfigure}[c]{.48\linewidth}
      \centering
      \includegraphics[width=\linewidth,page=2]{../fig/Halbranes_thule_domain_con_fondo.png}%
      \caption
        {%
          Ice thickness along each Halbrane profile%
          \label{Halbranes_thule}%
        }%
    \end{subfigure}
  \end{tabular}
  \caption
    {%
      Schematic representation of thule ice sheet showing ice thickness along Caprona and Halbrane profiles.%
      \label{Thule_profiles_capronas_and_halbranes}%
    }
\end{figure}

In figure \ref{Thule_resolutions} a qualitative representation of the simulations results can be observed as well to have a visualization of the impact of the resolution on the grounded area of the domain. Similar to the results for the Cone circular domain, the blue part represents the grounded part and the grey part represents the part of the ice that is floating in water. 

\begin{figure}[!h]
	\centering % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_50km.png}
		\caption{image1}
		\label{fig:1}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_20km.png}
		\caption{image2}
		\label{fig:2}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_10km.png}
		\caption{image3}
		\label{fig:3}
	\end{subfigure}
	
	\medskip
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_5km.png}
		\caption{image4}
		\label{fig:4}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_2km.png}
		\caption{image5}
		\label{fig:5}
	\end{subfigure}\hfil % <-- added
	\begin{subfigure}{0.25\textwidth}
		\includegraphics[width=\linewidth]{../fig/Grounded_zone_1km.png}
		\caption{image6}
		\label{fig:6}
	\end{subfigure}
	\caption{Impact of the resolution in the grounded area}
	\label{Thule_resolutions}
\end{figure}

For the analysis of these results the same procedure was followed; the simulations were run using a quarter of the domain and the complete one, and the results for the grounding line position were analysed along the profile of Halbrane B and Caprona B for the quarter of the domain. A grounding line function is created and computed as the product of the grounded mask function and the negative of the bedrock position. The negative sign is introduced for the same reason as for the cone domain procedure, since the grounding line is an increasing function and as long as $z_b$ is equal to the bedrock position (namely, the ice sheet is grounded) this product will be negative, so if a negative sign is introduced, it will turn positive, making the inflexion point a unique maximum. This point that represents the position of the grounding line is identified per each resolution and the distance to the origin is calculated, along each one of the profiles Capronas and Halbranes.

The figure \ref{Grounding_lines__caprona_halbrane_comparison} shows the comparison of the grounding line position along the two types of profiles, Caprona and Halbrane for the quarter and complete domain. 

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Figure_THULE_GLpositions_Capronas.png}
		\caption{Grounding line positions along Capronas profiles.}
		\label{Thule_Capronas}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Figure_THULE_GLpositions_Halbranes.png}
		\caption{Grounding line positions along Halbrane profiles}
		\label{Thule_halbranes}
	\end{subfigure}
	\caption{Grounding line positions as a function of the resolution for quarter and complete thule domain along the Caprona and Halbrane profiles.}
	\label{Grounding_lines__caprona_halbrane_comparison}
\end{figure}

For this experiment, for the quarter of the domain there are only two profiles Caprona B and Halbrane B. For both profiles there is only a value of grounding line position, that is shown in figure \ref{Thule_Capronas} and \ref{Thule_halbranes} respectively. To compare these positions obtained for the quarter domain, the grounding line positions along Halbrane A,B, C and D are computed for the complete domain following the procedure described previously, and the mean, maximum and minimum value per each resolution are listed in figure \ref{Thule_halbranes}. The exact same procedure is applied using the results along the Capronas profiles. For both, the mean value of the grounding line position for the complete domain, and the grounding line position for the quarter domain, the associated error bars are also shown.

It can be observed that as the mesh resolution starts to decrease, the differences between the results for the grounding line positions along both profiles for the complete and quarter domain start to decrease, a similar behaviour observed in the cone circular domain results. 

\subsection{Comparison of parameters for each resolution for the different configurations}

An important parameter to take into account for the results for both experiments, is the computation time spent to complete all the simulations of the experiments. The figure \ref{Computation time} shows the relation between the number of nodes for each one of the mesh resolutions and the time.

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Figure_Time_vs_nodes_Segundos.png}
		\caption{Time for 32 processors used.}
		\label{32_proce}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Figure_Time_vs_nodes_32.png}
		\caption{Time for 1 processor.}
		\label{1_proce}
	\end{subfigure}
	\caption{Simulation time as a function of the number of nodes for each resolution mesh.}
	\label{Computation time}
\end{figure}

Figure \ref{32_proce} shows the time spent using the 32 processors to run all the simulations, while in the figure \ref{1_proce} it is shown the expected time for a 50000 years of simulation if 1 processor was used. 

In figure \ref{H_CONE_VS_TIME_VS_NODES} it can be observed also a comparison of the ice thickness variation in time, for each one of the resolutions for the cone circular domain experiment and the error graph associated to this ice thickness as a function of the number of nodes per each resolution.

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/H_CONE_full_all_res_vs_time.png}
		\caption{Ice thickess variation in time.}
		\label{H_CONE_VS_TIME}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/H_CONE_full_all_res_vs_num_nodes.png}
		\caption{Ice thickness error as a function of the number of nodes.}
		\label{H_CONE_VS_NODES}
	\end{subfigure}
	\caption{Ice thickess variation in time for the Cone circular domain experiment.}
	\label{H_CONE_VS_TIME_VS_NODES}
\end{figure}

As it can be observed, the ice thickess does not vary nor oscillates around each value for each resolution, which shows the convergence of the system.

The same figures can be plot for the thule experiment, where in figure X it can be observed the ice thickness variation as a function of time and the error or variation of the ice thickness as a function of the number of nodes per each resolution. In both cases, for the computation of $\epsilon_H$ the reference value of H it is assumed to be the one corresponding to 1km resolution. 

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/H_THULE_full_all_res_vs_time.png}
		\caption{Ice thickess variation in time.}
		\label{H_THULE_VS_TIME}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/H_THULE_full_all_res_vs_num_nodes.png}
		\caption{Ice thickness error as a function of the number of nodes.}
		\label{H_THULE_VS_NODES}
	\end{subfigure}
	\caption{Ice thickess variation in time for the Thule domain experiment.}
	\label{H_THULE_VS_TIME_VS_NODES}
\end{figure}

A similar procedure can be done for the volume of the ice sheet. In the figure \ref{Volume_CONE_VS_TIME_VS_NODES} it is shown the volume as a function of time and the relative variation associated taking into account the 1km resolution volume as the reference for the computation of $\epsilon_V$. It can be observed how the differences start to decrease as long as the resolution decreases until the 1 km reference resolution is reached. 

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Volume_CONE_full_all_res_vs_time.png}
		\caption{Volume variation in time.}
		\label{VOLUME_CONE_VS_TIME}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Volume_CONE_full_all_res_vs_num_nodes.png}
		\caption{Volume relative variation as a function of the number of nodes.}
		\label{VOLUME_CONE_VS_NODES}
	\end{subfigure}
	\caption{Volume variation in time for the cone domain experiment.}
	\label{Volume_CONE_VS_TIME_VS_NODES}
\end{figure}

In figure \ref{Volume_THULE_VS_TIME_VS_NODES}, the evolution in time for the volume is also computed for the thule domain per each resolution, as well as the relative variation having the 1km resolution volume as reference. 

\begin{figure}[!h]
	\centering
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Volume_THULE_full_all_res_vs_time.png}
		\caption{Volume variation in time.}
		\label{VOLUME_THULE_VS_TIME}
	\end{subfigure}%
	\begin{subfigure}{.5\textwidth}
		\centering
		\includegraphics[width=1.1\linewidth]{../fig/Volume_THULE_full_all_res_vs_num_nodes.png}
		\caption{Volume relative variation as a function of the number of nodes.}
		\label{VOLUME_THULE_VS_NODES}
	\end{subfigure}
	\caption{Volume variation in time for the thule domain experiment.}
	\label{Volume_THULE_VS_TIME_VS_NODES}
\end{figure}

\section{Discussion}

The outcomes of this research have provided insight into the importance of the mesh resolution in the prediction of important parameters like the grounding line position for the glaciers dynamics. The results obtained for the grounding line position for both experiments were consistent with the ones carried out by \cite{durand2009full} were they could show that the grounding line position results start to be consistent for a grid size smaller than 5km. In that case, a Full-Stokes model was implemented, while in this case a Shallow-Shelf approximation was carried out, decreasing the simulation time and the computational resources. For the complete domains, as well as for the quarter domains, the results start to be consistent after 5 km resolution meshes. 

However, this prediction should be interpreted with caution due to the limitations of the current research. As it can be observed in figure \ref{Computation time}, the time spent by simulations as a function of the number of nodes in the mesh was obtained, showing a linear behaviour. This expected computational time is calculated based on 50000 years of simulation, and shows that for example, to complete a simulation of a 1 km mesh ($3x10^6$ nodes), on 50000 years of simulation, the computing time would be around 2222 hours with the maximum computational time allowed in the laboratory using the 32 processors, as showed in figure \ref{32_proce}. This time would be 32 times greater if 1 processor is used, instead of using all, as shown in figure \ref{1_proce}. This is the main limitation of the project, due to the amount of time required for further simulations of mesh resolutions lower than 1km that could not be carried out for these reason. Besides, even that it has been shown according to the results that a shallow shelf approximation of the Full-Stokes equations can be a good approximation for the prediction of the grounding line position, further experiments with lower mesh resolutions need to be implemented to conclude a robust prediction of these result. 

On the other hand, with respect to the convergence of the simulations, figure \ref{h_and_h_velocities_cone} shows the range of values for the ice thickness rate of change after the steady state was reached, results that are later detailed on figure \ref{H_CONE_VS_TIME} and \ref{H_THULE_VS_TIME} for both configurations. In these last figures, it can be observed how after several iterations for different time steps, the ice thickness starts to converge to a constant value. Due to the large computation times discussed before, the implementation of this research was to perform each simulation starting from the previous one as a restart point, and that is the reason why it can be observed that each simluation for each resolution mesh starts from the previous value, (except for the 1km resolution simulation that was performed at the same time with the 2km one, starting from the 5km result, for both configurations.) The fact that the 1 km simulations were run starting from the 5km resolution result, may explain the reason why this simulation did not stabilized completely to a constant value, since it can be observed that it did not converged fully to a constant line. Also, the values of convergence were increasing as the resolution mesh decreased (from a very small close to 0 value for ice thickness for the 10km resolution, to around 1,77 m/y for the thule domain and 2,5 m/y for the cone domain). 

For these reasons, the convergence of the ice thickness can not be fully concluded after these results obtained. further simulations beyond 1km resolution mesh could be needed in order to evaluate the convergence to an specific value of ice thickness for a certain configuration domain. In figure \ref{h_and_h_velocities_cone} it can be observed in the right hand side the zones where the variation of the ice thickness was the lowest and the highest, and as stated before, since the simulations were run using the previous results as a restart point, the iterations started from these values and not from 0. For these reasons, for a certain time of simulation, it converged faster for the zones of the domain where the variables (in this case, the high thickness velocity) did not change too much with respect to one resolution or another, due to the simplicity of the zone or the geometry.

However, even if the convergence of the ice thickness can not be fully concluded as stated before, figures \ref{VOLUME_CONE_VS_TIME} and \ref{VOLUME_THULE_VS_TIME} show a different behaviour for the convergence of the domains volume. For both configurations, the volume variation in time converges to a constant value. The behaviour of convergence is similar to the one for the ice thickness, but in this case for both configuration the value of the volume starts to reach the same constant value as the resolution mesh decreases. For this case as well the 1 km resolution is taken as the reference for the computation of the relative variation and it can be observed in figure \ref{VOLUME_CONE_VS_NODES} and \ref{VOLUME_THULE_VS_NODES} that the differences decrease as a function of the number of nodes, with a slight difference for the 2 km resolution for both configurations. This difference in the convergence of the volume and the convergence of the ice thickness can be explained, by the fact that the volume not only depends of the ice thickness but also on the surface area. The computation of the volume stands for the summary of each volume per element, and each element surface area is greater than its thickness and ends up being the determinant quantity at the time of computing the complete domain volume. 

For these reasons, even if the results obtained show that the position of the grounding line can be well predicted using the SSA model for resolution meshes lower than 5km, these results may not indicate enough information about the convergence of variables as the ice thickness when varying the resolution. However, as it was shown, using only a quarter domain can reduce the computation time of further simulations and researches, and these way further simulations beyond 1km resolution meshes can be performed in order to reach to a convergence for these kind of variables.  

\section{Conclusion}

In this project an approach using a shallow shelf approximation (SSA) model was proposed to simulate the motion of glaciers with two different configuration topography. The ice flow is determined by solving the Stokes problem implemented in finite element code Elmer/Ice with the SSA assumptions. This problem was solved by taking into account the complete domain and also solving only a quarter of the domain, due to the symmetry of the system. The position of the grounding line was studied for different resolution meshes starting from 10km and up to 1km, and it was shown that despite the sensitivity of the grounding line to the mesh resolution, it started to converge for resolutions lower to 5km, despite the configuration or the topography as well. The results for the quarter domain for both topographies showed consistency with the results for the complete domain for the prediction of the grounding line position. However, further simulations need to be performed with resolution meshes lower than 1km to fully conclude the convergence of all the variable results. According to the results obtained in this research project, it can be a good path for future researches to run simulation experiments with a quarter of the domain to save computational time, as the results are consistent due to the symmetry, and it can be possible to model more realistic glacier topographies using SSA models. Developing approaches to model more realistic glacier topographies, can allowed to better understand and predict the dynamics of the glaciers along time, and this way it can be better understood its impact on the formation and changes of the ice sheets and their behaviour. 

\section{Acknowledgments} 

This research is part of the Calvin MIP intercomparison project proposed as part of the  PROTECT (projecting sea-level rise: from ice sheet to local implications), an EU project funded to assess and project changes in the land-based cryosphere, with fully quantified uncertainties to produce robust global, regional and local projections on a range of timescales. All the computations and simulations run and presented in this project were performed in the Institut des géosciences de l'environnement (IGE) and the Observatoire des sciences de l'univers de Grenoble (OSUG-B).

\pagebreak
\bibliographystyle{apalike}
\bibliography{./biblio}
\end{document}


